<section class="pb-3 d-flex flex-column justify-content-between bg-white page">
    <div>
        <div class="mb-4 position-relative d-flex justify-content-center align-items-center border-bottom page-title-control">
            <a routerLink="/category" class="position-absolute p-0 btn btn-goback">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="currentColor" class="bi bi-arrow-left" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M15 8a.5.5 0 0 0-.5-.5H2.707l3.147-3.146a.5.5 0 1 0-.708-.708l-4 4a.5.5 0 0 0 0 .708l4 4a.5.5 0 0 0 .708-.708L2.707 8.5H14.5A.5.5 0 0 0 15 8"/>
                  </svg>
            </a>
            <p class="mb-0">Các món đang chọn ({{selectingDishes() | total: 'dishes'}})</p>
        </div>
    
        <div class="px-3">
            <ul class="mb-4 list-unstyled">
                @for(dish of selectingDishes(); track dish.id; let first=$first) {
                    <li class="position-relative p-2 border rounded" [class.mt-3]="!first">
                        <div class="d-flex align-items-end justify-content-between gap-2">
                            <div class="d-flex align-items-center gap-2">
                                <div class="thumbnail">
                                    <img [src]="dish.avatar" alt="dish" class="d-block w-100 h-100">
                                </div>
                                <div class="d-flex flex-column justify-content-between align-self-stretch flex-1">
                                    <div class="dish-text">
                                        <p class="mb-1 text-truncate fs-sm">{{dish.title}} {{dish.title}}</p>
                                        <p class="text-truncate dish-description">{{dish.description}}</p>
                                    </div>
                                    
                                    <p>x {{dish.quantity}}</p>
                                </div>
                            </div>
            
                            <div class="text-end">
                                @if (dish.priceOutdated) {
                                    <p class="price outdated"><del>{{dish.priceOutdated | dotSeparator}}₫</del></p>
                                }
                                <p class="fs-sm price">{{dish | total: 'price' | dotSeparator}}₫</p>
                            </div>
                        </div>

                        <button class="position-absolute p-0 d-flex align-items-center justify-content-center rounded btn-remove">
                            <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor" class="bi bi-x-lg" viewBox="0 0 16 16">
                                <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8z"/>
                            </svg>
                        </button>
                    </li>
                }
            </ul>
        
            <div class="mb-5">
                <p class="mb-2">Ghi chú</p>
                <textarea class="fs-sm form-control" rows="2" placeholder="Thêm ghi chú"></textarea>
            </div>
    
            <div class="mb-3 d-flex justify-content-between lh-1">
                <p>Tổng tiền tạm tính</p>
                <p class="fs-lg price">{{selectingDishes() | total: 'price' | dotSeparator}}₫</p>
            </div>
            <p class="mb-5 text-end c-text-primary">Hoàn ngay <strong>36k</strong> với <strong>CashPlus</strong></p>
        </div>
    </div>
    <button 
        class="mx-3 d-block text-white btn c-bg-primary fs-sm btn-order"
        (click)="onOrder()"
    >Gửi yêu cầu đặt món</button>
</section>

@if( isShowConfirmDialog() ) {
    <div @fadeInOut class="position-fixed d-flex align-items-center justify-content-center confirm-dialog">
        <div class="p-4 rounded bg-white">
            <p class="mb-4 ">Bạn chắc chắn đặt những món đã chọn?</p>
            <div class="d-flex gap-3 fs-sm">
                <button class="flex-1 btn btn-secondary btn-large" (click)="onCloseConfirmDialog()">Không</button>
                <button class="flex-1 btn c-bg-primary text-white btn-large" (click)="onConfirm()">Đặt món</button>
            </div>
        </div>
    </div>
}

